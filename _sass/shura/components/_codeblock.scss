// Code block container
div.highlight {
  background-color: $crust;
  padding: $base-padding $base-padding * 2;
  margin: 0;
  border-radius: $base-border-radius;
  overflow-x: auto;
  -webkit-overflow-scrolling: touch;
}

// Inline code
.language-plaintext {
  background-color: $surface-0;
  color: $green;
  padding: $base-padding * 0.2 $base-padding * 0.5;
  border-radius: $base-border-radius * 0.25;
  font-size: $font-size-sm;
}

// Wrapper injected by code-utils.js for the label + copy button overlay
.code-wrapper {
  position: relative;
  margin: $base-margin * 1.5 0;
  border-radius: $base-border-radius;
  overflow: visible;

  // Hide label/button by default, show on hover
  .code-lang-label,
  .code-copy-btn {
    opacity: 0;
    transition: opacity 0.15s ease;
  }

  &:hover {
    .code-lang-label,
    .code-copy-btn {
      opacity: 1;
    }
  }
}

.code-lang-label {
  position: absolute;
  top: -0.75rem;
  left: 0.75rem;
  background-color: $surface-1;
  color: $subtext-1;
  font-size: $font-size-sm * 0.85;
  font-family: monospace;
  padding: 0.1rem 0.5rem;
  border-radius: $base-border-radius * 0.3;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  pointer-events: none;
  z-index: 1;
}

.code-copy-btn {
  position: absolute;
  top: 0.5rem;
  right: 0.5rem;
  background-color: $surface-1;
  color: $subtext-1;
  border: none;
  border-radius: $base-border-radius * 0.3;
  padding: 0.25rem 0.5rem;
  font-size: $font-size-sm * 0.85;
  cursor: pointer;
  z-index: 1;
  transition: background-color 0.15s ease, color 0.15s ease, opacity 0.15s ease;

  &:hover {
    background-color: $surface-2;
    color: $text;
  }

  &.copied {
    color: $green;
    background-color: $surface-2;
  }
}

// ─── Catppuccin Mocha — Rouge token mapping ────────────────────────────────

// Keywords
.highlight .k,
.highlight .kd,   // Keyword.Declaration (var, let, func, class, struct, etc.)
.highlight .kn,   // Keyword.Namespace  (import)
.highlight .kp,   // Keyword.Pseudo     (self, super)
.highlight .kr,   // Keyword.Reserved
.highlight .kc    // Keyword.Constant   (true, false, nil)
  { color: $mauve; font-weight: normal; }

.highlight .kt    // Keyword.Type
  { color: $yellow; font-style: italic; }

// Identifiers – functions
.highlight .nf,   // Name.Function
.highlight .fm    // Name.Function.Magic
  { color: $blue; }

// Identifiers – types / classes
.highlight .nc    // Name.Class
  { color: $yellow; }

.highlight .nn    // Name.Namespace
  { color: $lavender; }

// Identifiers – constants / properties
.highlight .no    // Name.Constant
  { color: $peach; }

.highlight .ni    // Name.Entity
  { color: $flamingo; }

.highlight .nd    // Name.Decorator  (@attribute in Swift)
  { color: $peach; font-style: italic; }

// Identifiers – variables
.highlight .nv,   // Name.Variable
.highlight .vc,   // Name.Variable.Class
.highlight .vg,   // Name.Variable.Global
.highlight .vi    // Name.Variable.Instance
  { color: $text; }

// Identifiers – builtins
.highlight .nb    // Name.Builtin
  { color: $red; }

.highlight .bp    // Name.Builtin.Pseudo (self as pseudo in some lexers)
  { color: $mauve; }

// Identifiers – generic / other names
.highlight .n     // Name (generic)
  { color: $text; }

.highlight .na    // Name.Attribute
  { color: $blue; }

.highlight .nt    // Name.Tag
  { color: $mauve; }

.highlight .nl    // Name.Label
  { color: $blue; }

.highlight .nx    // Name.Other
  { color: $text; }

// Literals – strings
.highlight .s,
.highlight .s1,   // Literal.String.Single
.highlight .s2,   // Literal.String.Double
.highlight .sb,   // Literal.String.Backtick
.highlight .sc,   // Literal.String.Char
.highlight .sd,   // Literal.String.Doc
.highlight .sh,   // Literal.String.Heredoc
.highlight .sx,   // Literal.String.Other
.highlight .sr,   // Literal.String.Regex
.highlight .ss    // Literal.String.Symbol
  { color: $green; }

.highlight .si,   // Literal.String.Interpol (string interpolation \())
.highlight .se    // Literal.String.Escape   (\n, \t, etc.)
  { color: $peach; }

// Literals – numbers
.highlight .m,
.highlight .mi,   // Literal.Number.Integer
.highlight .mf,   // Literal.Number.Float
.highlight .mh,   // Literal.Number.Hex
.highlight .mo,   // Literal.Number.Oct
.highlight .mb,   // Literal.Number.Bin
.highlight .il    // Literal.Number.Integer.Long
  { color: $peach; }

// Operators
.highlight .o,
.highlight .ow    // Operator.Word (as, is, in, where)
  { color: $sky; }

// Punctuation
.highlight .p     // Punctuation (braces, colons, semicolons)
  { color: $subtext-1; }

// Comments
.highlight .c,
.highlight .c1,   // Comment.Single
.highlight .cm,   // Comment.Multiline
.highlight .cp,   // Comment.Preproc
.highlight .cs,   // Comment.Special
.highlight .ch    // Comment.Hashbang
  { color: $overlay-2; font-style: italic; }

.highlight .cd    // Comment.Doc (/// doc comments in Swift)
  { color: $overlay-2; font-style: italic; }

// Generic diff markers
.highlight .gd    // Generic.Deleted
  { color: $red; background-color: rgba($red, 0.1); }

.highlight .gi    // Generic.Inserted
  { color: $green; background-color: rgba($green, 0.1); }

.highlight .ge    // Generic.Emph
  { font-style: italic; }

.highlight .gs    // Generic.Strong
  { font-weight: bold; }

.highlight .gu    // Generic.Subheading
  { color: $subtext-0; }

.highlight .gh    // Generic.Heading
  { color: $blue; font-weight: bold; }

.highlight .go    // Generic.Output
  { color: $subtext-0; }

.highlight .gp    // Generic.Prompt
  { color: $overlay-2; }

.highlight .gr    // Generic.Error
  { color: $red; }

.highlight .gt    // Generic.Traceback
  { color: $red; }

// Error token
.highlight .err
  { color: $red; }

// Whitespace
.highlight .w
  { color: $text; }
